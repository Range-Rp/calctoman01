const ALUMINIO_POR_LATA=3,RECICLAGEM_PARA_CHAPA=20,COBRE_POR_PILHA=2,ALUMINIO_PARA_ACO=60,COBRE_PARA_MOLA=20,CHAPAS_CORPO_PISTOLA=1,CHAPAS_CORPO_SUB=3,ACO_POR_PISTOLA=2,ACO_POR_SUB=2,MOLA_POR_PISTOLA=1,MOLA_POR_SUB=3;

function toIntermediates(a,b,c){const d=a*ALUMINIO_POR_LATA,e=Math.floor(b/RECICLAGEM_PARA_CHAPA),f=c*COBRE_POR_PILHA,g=Math.floor(d/ALUMINIO_PARA_ACO),h=Math.floor(f/COBRE_PARA_MOLA);return{aluminio:d,chapa:e,cobre:f,aco:g,mola:h}}function requiredRawFor(a,b){if(0>a||0>b)throw new Error("Quantidades não podem ser negativas");const c=a*CHAPAS_CORPO_PISTOLA+b*CHAPAS_CORPO_SUB,d=a*ACO_POR_PISTOLA+b*ACO_POR_SUB,e=a*MOLA_POR_PISTOLA+b*MOLA_POR_SUB,f=d*ALUMINIO_PARA_ACO,g=0<f?Math.ceil(f/ALUMINIO_POR_LATA):0,h=e*COBRE_PARA_MOLA,i=0<h?Math.ceil(h/COBRE_POR_PILHA):0;return{pistolas:a,subs:b,chapa_needed:c,aco_needed:d,mola_needed:e,aluminio_needed:f,latas_needed:g,reciclavel_needed:c*RECICLAGEM_PARA_CHAPA,cobre_needed:h,pilhas_needed:i}}function maxOnlyPistolas(a){return Math.min(Math.floor(a.chapa/CHAPAS_CORPO_PISTOLA),Math.floor(a.aco/ACO_POR_PISTOLA),Math.floor(a.mola/MOLA_POR_PISTOLA))}function maxOnlySubs(a){return Math.min(Math.floor(a.chapa/CHAPAS_CORPO_SUB),Math.floor(a.aco/ACO_POR_SUB),Math.floor(a.mola/MOLA_POR_SUB))}function bestCombination(a){let b={p:0,s:0,total:0};const c=Math.floor(a.chapa/CHAPAS_CORPO_PISTOLA);for(let d=0;d<=c;d++){const c=d*CHAPAS_CORPO_PISTOLA,e=d*ACO_POR_PISTOLA,f=d*MOLA_POR_PISTOLA,g=a.chapa-c,h=a.aco-e,i=a.mola-f;if(0>g||0>h||0>i)continue;const j=Math.floor(g/CHAPAS_CORPO_SUB),k=Math.floor(h/ACO_POR_SUB),l=Math.floor(i/MOLA_POR_SUB),m=Math.min(j,k,l);d+m>b.total&&(b={p:d,s:m,total:d+m})}return b}const el=a=>document.getElementById(a);function printInv(a){const b=toIntermediates(a.latas,a.reciclavel,a.pilhas),c=maxOnlyPistolas(b),d=maxOnlySubs(b),e=bestCombination(b);return`=== Inventário inicial ===\nLatas: ${a.latas}\nMaterial reciclável: ${a.reciclavel}\nPilhas: ${a.pilhas}\n\n=== Intermediários disponíveis ===\nAlumínio: ${b.aluminio}\nChapas de metal: ${b.chapa}\nCobre: ${b.cobre}\nAço forgado: ${b.aco}\nMolas: ${b.mola}\n\n=== Produção possível ===\nMáximo apenas pistolas: ${c}\nMáximo apenas subs: ${d}\n\n=== Melhor combinação (maximizar total pistolas+subs) ===\nPistolas: ${e.p}  |  Subs: ${e.s}  |  Total: ${e.total}`}function printReq(a){return`=== Requisitos para produzir ===\nPistolas: ${a.pistolas}\nSubs: ${a.subs}\n\n--- Intermediários necessários ---\nChapas de metal: ${a.chapa_needed}\nAço forgado: ${a.aco_needed}\nMolas: ${a.mola_needed}\n\n--- Matéria-prima bruta mínima necessária ---\nAlumínio total necessário: ${a.aluminio_needed}\nLatas necessárias: ${a.latas_needed}\nMaterial reciclável (unidades) necessárias: ${a.reciclavel_needed}\nCobre total necessário: ${a.cobre_needed}\nPilhas necessárias: ${a.pilhas_needed}`}window.addEventListener("DOMContentLoaded",()=>{el("btn-calc-inv").addEventListener("click",()=>{const a={latas:parseInt(el("in-latas").value||0,10),reciclavel:parseInt(el("in-recic").value||0,10),pilhas:parseInt(el("in-pilhas").value||0,10)};el("out-inv").textContent=printInv(a)}),el("btn-require").addEventListener("click",()=>{const a=parseInt(el("in-pistolas").value||0,10),b=parseInt(el("in-subs").value||0,10);try{const c=requiredRawFor(a,b);el("out-req").textContent=printReq(c)}catch(a){el("out-req").textContent="Erro: "+a.message}}),el("btn-per-unit").addEventListener("click",()=>{const a=requiredRawFor(1,0),b=requiredRawFor(0,1);el("out-req").textContent=`=== Requisitos por unidade ===\n\n-- 1 Pistola --\n${printReq(a)}\n\n-- 1 Sub --\n${printReq(b)}`})});